{"data":{"site":{"siteMetadata":{"title":"jason.log","author":"Jaesung Lee","siteUrl":"https://jason0853.github.io","comment":{"disqusShortName":"","utterances":"jason0853/gatsby-blog"},"sponsor":{"buyMeACoffeeId":"HFzVClS"}}},"markdownRemark":{"id":"7e252ff0-6918-58b6-8ca9-6c5a55828351","excerpt":" 클로저란?MDN…","html":"<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/302ed6a6859995a5ab041f11cc376304/2a182/closure-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 115.45454545454545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsSAAALEgHS3X78AAADhElEQVQ4y41VaVsaZxSdX9J+qALDPhsMDLM6IAhWBDXuoS6BJE1KlSR2e9qmNv9V+wPyiTm99wUj+oDth8PAy73nnvduI/XeffrcG336/Hz09wSXd7j+D8zYkh9zMJdEH6CDCS4Zf+Ho4v/h+OIax5fXX/yZS6LD6HD4Z7TVv4rWT0fRem8UdY4vos7JRbR5SjiZjw791zm7jLrn76KdwVV0+MMfEXNJRz9+RPfFe2j5Cla0MrxKAbJjQs4TkkXIqSeQNpGgZypnoXs2AnNJB29/R6s3hJ0t4a1j47yrQD4oIq4XEI8biCenkBcgoQvyb4/fYJ+4pN3Xv2D96HvESM1XMQ1fLxuILRHIcOIwRfz+LJEsfAH/ZqXNg5dgLmnn5U9o7PWRTpdQ1esI9BrKSgBbCZHRLKTsCtKkPBXYKNghVM0nRSa+WdYowEQlK2w8OwdzSduDKzR2X4hcKJkKtKwNT6uhmPWQMEpINz2kfRsZxYJhOXADH6ZlwzAtKBTwjnB15xTbgw9E2P+AOrGz/KWEJp6h3kAh5yJr2tBqAfSyDyPlQFcqCPwV+OEKbNeDZtiicCymtn2Crf77h4QiGhnwdQNtFVaOyGQbVbUh0uArNXhGA4rhI6c4WI7rSEwVPiI8e5Bkhk/XZqWOGiKVKSGobqDdPYRquETENzHuRSxSyIaZXJly40CWC8hQoVJJE0ly4PMs9RuTz1Z6LuHqzpkwZCd56hyT9Qf9xi2zsG3mEaZZmUp5meP0FBZeOc5VjqsTo/h9fsS0UL/F5An4jFNzpzY2nZSHCqkoSer2utGEkqeea3nI1qn/AgeZmiuaOp+3oKseqvVNVGubCMINuH5T5JuDzylKEWnZnMytWkQsRdHTpDRHc50tiIApmpAMFSZH/cjPjCiS+agPBxNCnkdFd2EUA6iqK/Kp0FNUlohij4ojMLMcVrdpUkgczfKVIMzS+lrf2IPjromrhLW2uJZZDmkivIWFEudEWKfC8hhLz179jNbBKxFlKaZSYTSRdPGdcN8qMytrutJmt80aLRjmovX165g287ja6Y291t7Yrm+NrVpnXK5uCpTC9lzwfxWydZu745B8mYPW11g6HH4Ue4wT2v5uSLvxtdhta/sDQn8BBsKmRbbsw77MQa8SMOHN/pvfbmiX3dL74ZYi3bZPhv+Q4dMgG7ZlH6rD7R5xEOHNv3uGQLfHaZe5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"closure 1\"\n        title=\"\"\n        src=\"/static/302ed6a6859995a5ab041f11cc376304/b9e4f/closure-1.png\"\n        srcset=\"/static/302ed6a6859995a5ab041f11cc376304/cf440/closure-1.png 148w,\n/static/302ed6a6859995a5ab041f11cc376304/d2d38/closure-1.png 295w,\n/static/302ed6a6859995a5ab041f11cc376304/b9e4f/closure-1.png 590w,\n/static/302ed6a6859995a5ab041f11cc376304/2a182/closure-1.png 660w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h2 id=\"i-classdevicon-javascript-plain-colored-stylefont-size-13remi-클로저란\"><a href=\"#i-classdevicon-javascript-plain-colored-stylefont-size-13remi-%ED%81%B4%EB%A1%9C%EC%A0%80%EB%9E%80\" aria-label=\"i classdevicon javascript plain colored stylefont size 13remi 클로저란 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><i class=\"devicon-javascript-plain colored\" style=\"font-size: 1.3rem;\"></i> 클로저란?</h2>\n<p><a href=\"https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Closures\">MDN</a>에서 다음과 같이 정의를 내린다.</p>\n<blockquote>\n<p>함수와 함수가 선언된 어휘적 환경의 조합</p>\n</blockquote>\n<p>우선 이해가 잘 되지 않는다. 🤔🤔</p>\n<p>코드를 보자!!</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">person</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> _name <span class=\"token operator\">=</span> <span class=\"token string\">'Jason'</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> _name\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">var</span> getName <span class=\"token operator\">=</span> <span class=\"token function\">person</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// ✅ 클로저 형성</span></span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//  'Jason'</span></code></pre></div>\n<p>보통 프로그래밍에서 함수가 실행되고 나면 함수의 생명주기가 끝나기 때문에 내부에 선언되었던 변수들은 접근할 수 없는 것이 일반적이다. 하지만 자바스크립트에서는 리턴한 함수가 <code class=\"language-text\">closure</code> 환경을 형성하여 유효범위 내에 있는 변수가 참조 가능하다.</p>\n<p>결국 위 코드를 설명하면 변수 <code class=\"language-text\">getName</code>은 <code class=\"language-text\">person()</code>의 리턴한 함수의 인스턴스에 대한 참조이며\b 변수 <code class=\"language-text\">_name</code>에 접근할 수 있는 어휘적 유효 범위안에 있다.</p>\n<h3 id=\"실용적인-클로저\"><a href=\"#%EC%8B%A4%EC%9A%A9%EC%A0%81%EC%9D%B8-%ED%81%B4%EB%A1%9C%EC%A0%80\" aria-label=\"실용적인 클로저 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실용적인 클로저</h3>\n<p>클로저를 어떤 상황에서 쓰면 좋을까?</p>\n<blockquote>\n<p>어떤 데이터(어휘적 환경)와 그 데이터를 조작하는 함수를 연관시켜주기 때문에 유용하다.</p>\n</blockquote>\n<p>일반적으로 웹개발을 할 때 프론트엔드에서는 이벤트 기반으로 하는 코드를 많이 접하게 된다.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">person</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> _greet <span class=\"token operator\">=</span> <span class=\"token string\">'Hello, '</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'result'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> _greet <span class=\"token operator\">+</span> name\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> $greet1 <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'greet1'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> $greet2 <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'greet2'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> $greet3 <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'greet3'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// ✅ 클로저 형성</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">var</span> greet1 <span class=\"token operator\">=</span> <span class=\"token function\">person</span><span class=\"token punctuation\">(</span>$greet1<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">var</span> greet2 <span class=\"token operator\">=</span> <span class=\"token function\">person</span><span class=\"token punctuation\">(</span>$greet2<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">var</span> greet3 <span class=\"token operator\">=</span> <span class=\"token function\">person</span><span class=\"token punctuation\">(</span>$greet3<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span></span>\n$greet1<span class=\"token punctuation\">.</span>onclick <span class=\"token operator\">=</span> greet1\n$greet2<span class=\"token punctuation\">.</span>onclick <span class=\"token operator\">=</span> greet2\n$greet3<span class=\"token punctuation\">.</span>onclick <span class=\"token operator\">=</span> greet3</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>greet1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Jason<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>greet2<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Jeff<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>greet3<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Jaesung<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>result<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>각각의 버튼을 변수 <code class=\"language-text\">$greet1</code>, <code class=\"language-text\">$greet2</code>, <code class=\"language-text\">$greet3</code>에 정의하고 버튼 안에 있는 텍스트를 <code class=\"language-text\">person</code>함수의 인자값으로 할당한다. 결국 하나의 메소드를 가지고 각기 다른 클로저를 형성(<code class=\"language-text\">greet1</code>, <code class=\"language-text\">greet2</code>, <code class=\"language-text\">greet3</code>)하여 <code class=\"language-text\">onclick</code> 이벤트에 연결시켜준다.</p>\n<p><img src=\"/closure-2-e05e33735344fa6ff14ce401ab5a7003.gif\"></p>\n<p>짜잔!! 위와 같은 결과물이 나오면 성공!! 👍👍</p>\n<h3 id=\"클로저의-은닉화와-캡슐화\"><a href=\"#%ED%81%B4%EB%A1%9C%EC%A0%80%EC%9D%98-%EC%9D%80%EB%8B%89%ED%99%94%EC%99%80-%EC%BA%A1%EC%8A%90%ED%99%94\" aria-label=\"클로저의 은닉화와 캡슐화 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클로저의 은닉화와 캡슐화</h3>\n<p>자바스크립트는 다른 프로그래밍 언어와 달리 private method 기능을 지원하지 않는다. 하지만 <strong>클로저</strong>를 이용하여 private 변수 및 메소드를 흉내낼 수 있다.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">makeUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> _password <span class=\"token operator\">=</span> <span class=\"token string\">'0000000'</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">_generatePassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>_password <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">10000000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">setPassword</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">_generatePassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">getPassword</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> _password\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">var</span> jaesung <span class=\"token operator\">=</span> <span class=\"token function\">makeUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">var</span> jason <span class=\"token operator\">=</span> <span class=\"token function\">makeUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>jaesung<span class=\"token punctuation\">.</span><span class=\"token function\">getPassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 0000000</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>jason<span class=\"token punctuation\">.</span><span class=\"token function\">getPassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 0000000</span>\n\njaesung<span class=\"token punctuation\">.</span><span class=\"token function\">setPassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>jaesung<span class=\"token punctuation\">.</span><span class=\"token function\">getPassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 1044469</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>jason<span class=\"token punctuation\">.</span><span class=\"token function\">getPassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 0000000</span>\n\njason<span class=\"token punctuation\">.</span><span class=\"token function\">setPassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>jaesung<span class=\"token punctuation\">.</span><span class=\"token function\">getPassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 1044469</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>jason<span class=\"token punctuation\">.</span><span class=\"token function\">getPassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 1362642</span></code></pre></div>\n<p><code class=\"language-text\">jaesung</code>과 <code class=\"language-text\">jason</code>이라는 두 명의 유저를 생성했다. 그리고 생성한 유저의 초기 비밀번호는 <code class=\"language-text\">0000000</code>이다. 각각의 유저에게 임시 비밀번호를 전송해주려고 할때 <strong>public</strong> api로 노출된 <code class=\"language-text\">setPassword</code> 메서드를 통해서만 발급될 수 있다. 결국 <code class=\"language-text\">_password</code> 변수와 <code class=\"language-text\">_generatePassword</code> 함수는 클로저를 형성한 이후 공유된 api인 <code class=\"language-text\">getPassword</code>, <code class=\"language-text\">setPassword</code>외에는 어디서도 접근 불가능하다. 그리고 하나의 클로저에서 변수 값을 변경해도 다른 클로저의 값에는 영향을 주지 않으며 독립성을 유지한다.</p>\n<h3 id=\"반복문-클로저로-해결하기\"><a href=\"#%EB%B0%98%EB%B3%B5%EB%AC%B8-%ED%81%B4%EB%A1%9C%EC%A0%80%EB%A1%9C-%ED%95%B4%EA%B2%B0%ED%95%98%EA%B8%B0\" aria-label=\"반복문 클로저로 해결하기 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>반복문 클로저로 해결하기</h3>\n<p>지금 보는 예제는 정말 수 없이 봐왔던 예제이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 🤔 3, 3, 3  why?</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>변수 <code class=\"language-text\">i</code>는 <code class=\"language-text\">setTimeout</code>이 실행되기 전에 1초 동안 조건을 다 순회한 뒤 이미 3이 되어버린 상태!! 그래서 log에 3이라는 숫자가 3번 찍히는걸 볼 수 있다. 그럼 어떻게 해결해야 될까?</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// ❌ wrong way</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 0, 1, 2 즉시 실행되므로 1초 뒤에 실행되지 않는다.</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token number\">1000</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ✅ Good!!</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">;</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">j</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 😃 0, 1, 2</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ✅ Good!!</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">;</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">var</span> _j <span class=\"token operator\">=</span> i</span>    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>_j<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 😃 0, 1, 2</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>IIFE(Immediately Invoked Function Expressions) 패턴</strong>을 사용하여 <code class=\"language-text\">setTimeout</code> 함수 콜백에 새로운 어휘적 환경이 생성된다. 결국 <code class=\"language-text\">i</code> 값은 단일 환경이 아닌 세개의 각기 다른 환경(클로저)에서의 값을 소유하게 된다.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// 👍 Better!!</span></span><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 0, 1, 2</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>각각의 \b클로저 환경을 생성하는 것보다는 ES6 문법인 <code class=\"language-text\">let</code> 키워드를 사용하여 <code class=\"language-text\">i</code>를 <code class=\"language-text\">{}</code> 블록 범위 단위의 스코프로 각각 형성하는 것이다. 그럼 <code class=\"language-text\">for</code> 구문이 순회할 때마다 각기 다른 값이 다른 스코프에 저장되어 올바르게 출력되는걸 확인할 수 있다.</p>\n<h3 id=\"클로저-성능\"><a href=\"#%ED%81%B4%EB%A1%9C%EC%A0%80-%EC%84%B1%EB%8A%A5\" aria-label=\"클로저 성능 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클로저 성능</h3>\n<blockquote>\n<p>As long as closures are active, this memory cannot be garbage collected. Therefore, closures can lead to memory leaks if not used well.</p>\n</blockquote>\n<p>즉 다시 말해서, 클로저가 활성화 되어 있는 동안, 메모리는 GC가 회수하지 않을 수 있다. 그러므로 잘 사용하지 않으면 메모리 누수가 발생할 수 있다. 😭😭</p>\n<p>그럼 해결 방법은?</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">closure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> _name <span class=\"token operator\">=</span> <span class=\"token string\">'Closure'</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> _name\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> getClosure <span class=\"token operator\">=</span> <span class=\"token function\">closure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">getClosure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// closure</span>\n\n<span class=\"gatsby-highlight-code-line\">getClosure <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span> <span class=\"token comment\">// ✅ right way</span></span></code></pre></div>\n<p>클로저 사용이 끝난 뒤 <code class=\"language-text\">null</code> 값으로 제거해준다.</p>\n<h3 id=\"wrap-up\"><a href=\"#wrap-up\" aria-label=\"wrap up permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wrap-up</h3>\n<p>지금까지 클로저에 대한 기본개념, 응용, 문제해결, 성능 이슈에 대해 다루어봤다. 이번에 정리하고 나니 몬가 콱 막힌 부분이 풀리는(?) 느낌이 살짝 드는것 같다. 😃😃</p>\n<h3 id=\"perference\"><a href=\"#perference\" aria-label=\"perference permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Perference</h3>\n<ul>\n<li><a href=\"https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Closures#%EC%8B%A4%EC%9A%A9%EC%A0%81%EC%9D%B8_%ED%81%B4%EB%A1%9C%EC%A0%80\">MDN 클로저</a></li>\n<li><a href=\"https://hyunseob.github.io/2016/08/30/javascript-closure/\">DailyEngineering 블로그</a></li>\n</ul>","frontmatter":{"title":"클로저 이해하기","date":"June 08, 2019"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/Javascript/closure/","previous":{"fields":{"slug":"/aws/getting-started-with-aws-amplify-and-react/"},"frontmatter":{"title":"AWS Amplify와 React로 어플리케이션 만들기","category":"aws"}},"next":null}}